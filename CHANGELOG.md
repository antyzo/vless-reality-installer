# Changelog

## [1.1] - 2025-09-25

### Fixed
- ✅ Исправлена критическая ошибка с пакетом `netstat-inet` → заменен на `net-tools` для Ubuntu/Debian
- ✅ Улучшена функция определения операционной системы с поддержкой современного стандарта `/etc/os-release`
- ✅ Добавлена поддержка новых дистрибутивов: Rocky Linux, AlmaLinux, Fedora
- ✅ Добавлена автоматическая проверка доступности пакетного менеджера (fallback apt → apt-get, dnf → yum)

### Enhanced
- ✅ Улучшена функция поиска свободных портов с множественными fallback методами:
  - Приоритет: `ss` (современная замена netstat)
  - Fallback: `netstat` (для старых систем)
  - Альтернатива: проверка через `/proc/net/tcp` (если команды недоступны)
- ✅ Добавлена проверка установки всех критических зависимостей
- ✅ Улучшен процесс установки зависимостей с дополнительными полезными пакетами
- ✅ Добавлено ограничение попыток поиска портов для предотвращения бесконечного цикла

### Added
- ✅ Поддержка `dnf` пакетного менеджера для новых версий RHEL/CentOS/Fedora
- ✅ Автоматическая установка EPEL репозитория для CentOS при необходимости
- ✅ Дополнительные системные пакеты для лучшей совместимости

### Technical Details
- Замена устаревшего `netstat-inet` на корректный `net-tools`
- Модернизация определения ОС с использованием стандарта systemd
- Улучшенная обработка ошибок и fallback логика
- Более надежная проверка портов с тремя уровнями fallback

## [1.2] - 2025-09-29

### Fixed - Критическое исправление файрвола
- ✅ **ИСПРАВЛЕНА ГЛАВНАЯ ПРОБЛЕМА**: UFW теперь автоматически активируется при установке
- ✅ Добавлена проверка статуса UFW перед добавлением правил
- ✅ Добавлен fallback на iptables если UFW недоступен
- ✅ Улучшена обработка firewalld для CentOS/RHEL

### Enhanced - Улучшения диагностики
- ✅ Добавлена финальная проверка системы перед завершением установки
- ✅ Автоматическая проверка статуса Xray сервиса
- ✅ Проверка прослушивания порта VPN сервером
- ✅ Проверка статуса файрвола и открытых портов
- ✅ Проверка создания клиентских конфигураций

### Technical Details
**Проблема**: UFW добавлял правила, но оставался неактивным, что блокировало все подключения
**Решение**: Принудительная активация UFW с проверкой статуса и множественными fallback методами

**До**: Сервер устанавливался, но UFW был неактивен → подключения не работали  
**После**: UFW автоматически активируется → VPN работает сразу после установки
